{% load static %}
<head>
    <title>My Feedback</title>
    <link rel="stylesheet" href="{% static 'pos_app/css/feedback.css' %}">
</head>

<div class="container">
    <h2>My Feedback</h2>
    <ul>
        {% for f in feedbacks %}
            <li>
                <div class="feedback-content">
                    <strong>{{ f.rating }} Stars</strong> - {{ f.comment }}
                </div>
                <div class="actions">
                    <a href="{% url 'edit_feedback' f.id %}">Edit</a>
                    <button class="deleteBtn" data-id="{{ f.id }}">Delete</button>
                </div>
            </li>
        {% empty %}
            <li>No feedback submitted yet.</li>
        {% endfor %}
    </ul>
    <a href="{% url 'profile' %}">Back to Profile</a>
</div>

<div id="deleteModal">
    <div class="modal-content">
        <p>Are you sure you want to delete this feedback?</p>
        <form id="deleteForm" method="post">
            {% csrf_token %}
            <button type="submit">Yes, Delete</button>
            <button type="button" id="cancelDelete">Cancel</button>
        </form>
    </div>
</div>

<script>
    const modal = document.getElementById('deleteModal');
    const deleteForm = document.getElementById('deleteForm');
    const cancelBtn = document.getElementById('cancelDelete');

    document.querySelectorAll('.deleteBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            const feedbackId = this.dataset.id;
            // The action attribute must point to the delete URL
            deleteForm.action = `/feedback/delete/${feedbackId}/`; 
            // modal is set to display: flex in the CSS when visible
            modal.style.display = 'flex'; 
        });
    });

    cancelBtn.addEventListener('click', function() {
        modal.style.display = 'none';
    });
</script>