{% load static %}
<head>
    <title>All User Feedback</title>
    <link rel="stylesheet" href="{% static 'pos_app/css/feedback.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> 
</head>

{% block content %}

<div class="container" style="max-width: 1200px;"> <div class="top-actions">
        <a href="{% url 'dashboard' %}" class="btn-secondary">
            <i class="fa-solid fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>

    <h2>All User Feedback</h2>
    
    {% if feedbacks %}
        <table id="feedbackTable" class="feedback-table">
            <thead>
                <tr>
                    <th style="width: 15%;"><i class="fa-solid fa-user"></i> User</th>
                    <th style="width: 15%;"><i class="fa-solid fa-star"></i> Rating</th>
                    <th style="width: 50%;"><i class="fa-solid fa-comment-dots"></i> Comment</th>
                    <th style="width: 20%;"><i class="fa-solid fa-clock"></i> Submitted On</th>
                </tr>
            </thead>
            <tbody>
                {% for feedback in feedbacks %}
                <tr>
                    <td>
                        <strong>{{ feedback.user.username|default:"[Deleted User]" }}</strong>
                    </td>
                    
                    <td>
                        <div class="rating-display">
                            {# Assuming 'star_range' is passed and is a range (1 to 5) #}
                            {% for i in star_range %} 
                                {% if i <= feedback.rating %}
                                    <i class="fa-solid fa-star rated"></i>
                                {% else %}
                                    <i class="fa-regular fa-star unrated"></i>
                                {% endif %}
                            {% endfor %}
                            <span class="rating-value">({{ feedback.rating }}/5)</span>
                        </div>
                    </td>
                    
                    <td class="comment-cell">
                        {{ feedback.comment|default:"— No Comment Provided —"|truncatechars:100 }}
                    </td>
                    
                    <td class="date-cell">
                        {{ feedback.created_at|date:"Y-m-d" }}<br>
                        <small>{{ feedback.created_at|date:"H:i" }}</small>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="empty" style="text-align: center; padding: 40px; border: 1px dashed #ced4da; border-radius: 8px;">
            <i class="fa-solid fa-face-frown" style="color: var(--text-color-muted); margin-right: 10px;"></i> No feedback has been submitted to the system yet. 
        </p>
    {% endif %}

</div>

{% endblock content %}